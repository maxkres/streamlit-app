# Выводы по домашнему заданию №1: Регрессия с инференсом

## Что было сделано

### 1. Exploratory Data Analysis (EDA)
- Проведен первичный анализ данных: проверка пропусков, дубликатов, типов данных
- Обнаружено 1799 дубликатов по признакам, удалены, финальный размер train: 5840 объектов
- Пропуски в числовых признаках заполнены медианами из train
- Признаки `mileage`, `engine`, `max_power` преобразованы из строк в числа
- Удален столбец `torque` для упрощения
- Построены визуализации: pairplot, корреляционная матрица

### 2. Модель на вещественных признаках
- Отобраны числовые признаки: year, km_driven, mileage, engine, max_power, seats
- Обучена LinearRegression: R² test = ~0.59
- Применена стандартизация признаков
- Наиболее важный признак: max_power
- Lasso с GridSearchCV: лучший alpha ≈ 100, веса не занулились (регуляризация слабая)
- ElasticNet с GridSearchCV: лучшие параметры alpha ≈ 0.316, l1_ratio = 0.5

### 3. Добавление категориальных признаков
- Удален столбец `name` (высокая кардинальность)
- Применено OneHot-кодирование для fuel, seller_type, transmission, owner, seats (drop='first')
- Ridge с GridSearchCV на полном наборе признаков: R² test ≈ 0.67 - лучший результат

### 4. Бизнес-метрика
- Реализована метрика: доля прогнозов с ошибкой ≤10%
- Ridge показала лучший результат: ~24.5% прогнозов с ошибкой ≤10%

### 5. Streamlit-приложение
- Реализованы 3 раздела: EDA, Прогноз, Веса модели
- Поддержка ручного ввода и загрузки CSV
- Визуализация топ-20 важных признаков

### 6. Сохранение артефактов
- Модель Ridge сохранена в `model_pipeline.pkl` вместе с препроцессорами

## Результаты

| Модель | R² train | R² test | MSE test | Business metric |
|--------|----------|---------|----------|-----------------|
| LinearRegression | 0.590 | 0.588 | 16506558 | 0.196 |
| Lasso (best) | 0.590 | 0.588 | 16520482 | 0.198 |
| ElasticNet (best) | 0.590 | 0.588 | 16520482 | 0.198 |
| Ridge (full features) | 0.676 | 0.672 | 13171866 | 0.245 |

## Что дало наибольший прирост качества

1. **Добавление категориальных признаков** - основной прирост (R² +0.08)
2. **Регуляризация Ridge** - небольшое улучшение и защита от переобучения
3. **Стандартизация** - не улучшила качество, но позволила интерпретировать веса

## Что не удалось и почему

1. **Предобработка столбца `torque`** - не выполнена для упрощения, требует парсинга сложных строк
2. **Предобработка `name`** - удален из-за высокой кардинальности, можно было извлечь бренд
3. **Зануление весов Lasso** - оптимальная регуляризация оказалась слабой, все признаки значимы

## Оценка разработанного сервиса

### Что получилось хорошо
- Приложение интуитивно понятное, три четких раздела
- Визуализация EDA показывает ключевые распределения
- Два способа ввода данных (ручной и CSV)
- Визуализация весов с цветовой кодировкой (положительные/отрицательные)

### Ограничения
- Требуется наличие файла с моделью локально
- Нет валидации входных данных на корректность
- EDA показывает данные из сырого датасета, а не предобработанные
- Нет отображения confidence intervals для прогнозов

### Планируемые улучшения
- Добавить валидацию входных данных
- Реализовать confidence intervals через bootstrap
- Добавить сравнение с другими моделями
- Деплой на Streamlit Cloud с автоматической загрузкой модели
